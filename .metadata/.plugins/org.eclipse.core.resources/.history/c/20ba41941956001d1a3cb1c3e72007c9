package com.ryben.timesheet.repository;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

@Repository
public class UserDAOImpl implements UserDAO {

    @Autowired
    private JdbcTemplate jdbcTemplate;
	


	
	 	@Override
	    public Boolean authUser(String email, String password) throws SQLException {
	        // SELECT column_name(s) FROM table_name where column = value
	        final String sql = "SELECT role FROM students where email = ? and password= ?";
	        	 	PreparedStatement ps = jdbcTemplate.getDataSource().getConnection().prepareStatement(sql);
					ps.setString(1, email);
	        	 	ps.setString(2, password);
	        	 	ResultSet rs = ps.executeQuery();
	        	 	if(rs.next()) {
	        	 		return true;
	        	 	}
	        	 	else {
	        	 		return false;
	        	 	}
	        jdbcTemplate.execute(sql);
	    }
}
