package com.ryben.timesheet.repository;

import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.util.LinkedList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;

import com.ryben.timesheet.model.Employee;
import com.ryben.timesheet.model.ResponseDTO;

public class EmployeeDAOImpl implements EmployeeDAO {

	@Autowired
    private JdbcTemplate jdbcTemplate;
	
	@Override
	public ResponseDTO getAllEmployee() throws SQLException {
        ResponseDTO response = new ResponseDTO();
        LinkedList<Employee> emp = new LinkedList<Employee>();
        final String sql = "SELECT * FROM public.\"Employee\"";
	 	PreparedStatement ps = jdbcTemplate.getDataSource().getConnection().prepareStatement(sql);
		 ResultSet rs = ps.executeQuery();
		 //set the result set to the emp object
		 while(rs.next()) {
			 Employee e = new Employee();
			 e.setStatus(rs.getString("status"));
			 e.setDate_submitted(rs.getTimestamp("date_submitted"));
			 e.setName(rs.getString("name"));
			 e.setAddress(rs.getString("address"));
			 e.setPhone(rs.getString("phone"));
			 e.setEmail(rs.getString("email"));
			 e.setDob(rs.getDate("dob"));
			 e.setSsn(rs.getString("ssn"));
			 e.setEmpStatus(rs.getString("gender"));
			 e.setEmpStatus(rs.getString("poi"));
			 e.setEmpStatus(rs.getString("authorised_to_work_usa"));
			 e.setEmpStatus(rs.getString("convicted_felony"));
			 e.setEmpStatus(rs.getString("next_of_kin"));
			 e.setEmpStatus(rs.getString("today_date"));

			 emp.add(e);
		 }

			return null;
	}

}
