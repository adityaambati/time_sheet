package com.ryben.timesheet.repository;

import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Timestamp;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import com.ryben.timesheet.model.Events;

@Repository
public class EventsDAO {
	
	@Autowired
    private JdbcTemplate jdbcTemplate;
	
    public void saveEvent(Events event) {
        try {
        final String sql = "INSERT INTO public.\"events\" (event_id,event_name,supervisor_id,location,start_time,end_time,details) VALUES (?,?,?,?,?,?,?)";
        PreparedStatement ps = jdbcTemplate.getDataSource().getConnection().prepareStatement(sql);
        ps.setInt(1, event.getEventID());
        ps.setString(2, event.getEventName());
        ps.setInt(3, event.getSupervisorID());
        ps.setString(4, event.getLocation());

			ps.setTimestamp(5, new Timestamp(event.getStartTime().getTime()));
		
        ps.setTimestamp(6, new Timestamp(event.getEndTime().getTime()));
        ps.setString(7, event.getDetails());
        ps.executeUpdate();
        } catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
        
    }
	

}
